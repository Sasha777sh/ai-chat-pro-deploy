# üîó –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Webhook –¥–ª—è YooKassa

## ‚úÖ –ö–ª—é—á–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã

- ‚úÖ `YK_SHOP_ID` = `1163961`
- ‚úÖ `YK_SECRET_KEY` = `live_SY4gLP1faET4ZUupEm4QhY-ixvgjhOqvdbqzJ9sgrGU`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –≤ Vercel (Production, Preview, Development)
- ‚úÖ –î–µ–ø–ª–æ–π –æ–±–Ω–æ–≤–ª—ë–Ω

---

## üîß –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Webhook –≤ YooKassa

### –®–∞–≥ 1: –í–æ–π–¥–∏ –≤ YooKassa

1. –û—Ç–∫—Ä–æ–π <https://yookassa.ru/my>
2. –í–æ–π–¥–∏ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏** ‚Üí **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** (–∏–ª–∏ **Webhooks**)
2. –ù–∞–∂–º–∏ **"–î–æ–±–∞–≤–∏—Ç—å URL"** –∏–ª–∏ **"–°–æ–∑–¥–∞—Ç—å webhook"**

### –®–∞–≥ 3: –£–∫–∞–∂–∏ URL

**Webhook URL:**

```
https://chatedem.com/api/yookassa/webhook
```

### –®–∞–≥ 4: –í—ã–±–µ—Ä–∏ —Å–æ–±—ã—Ç–∏—è

–í—ã–±–µ—Ä–∏ —Å–æ–±—ã—Ç–∏–µ:

- ‚úÖ **`payment.succeeded`** ‚Äî —É—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞

(–ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–∏—Ç—å `payment.canceled` –¥–ª—è –æ—Ç–º–µ–Ω—ã, –Ω–æ —ç—Ç–æ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –®–∞–≥ 5: –°–æ—Ö—Ä–∞–Ω–∏

–ù–∞–∂–º–∏ **"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"** –∏–ª–∏ **"–°–æ–∑–¥–∞—Ç—å"**

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ webhook URL

1. –í YooKassa Dashboard –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω webhook
2. –°—Ç–∞—Ç—É—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **"–ê–∫—Ç–∏–≤–µ–Ω"** –∏–ª–∏ **"Enabled"**

### –¢–µ—Å—Ç 2: –¢–µ—Å—Ç–æ–≤–∞—è –æ–ø–ª–∞—Ç–∞

1. –û—Ç–∫—Ä–æ–π <https://chatedem.com/account>
2. –ù–∞–∂–º–∏ **"üè¶ –ÆKassa (990‚ÇΩ/–º–µ—Å)"**
3. –î–æ–ª–∂–Ω–∞ –æ—Ç–∫—Ä—ã—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–ø–ª–∞—Ç—ã YooKassa
4. –ò—Å–ø–æ–ª—å–∑—É–π —Ç–µ—Å—Ç–æ–≤—É—é –∫–∞—Ä—Ç—É:
   - **–ù–æ–º–µ—Ä:** `5555 5555 5555 4444`
   - **–°—Ä–æ–∫:** –ª—é–±–∞—è –±—É–¥—É—â–∞—è –¥–∞—Ç–∞
   - **CVC:** –ª—é–±—ã–µ 3 —Ü–∏—Ñ—Ä—ã
5. –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã:
   - YooKassa –æ—Ç–ø—Ä–∞–≤–∏—Ç webhook –Ω–∞ —Ç–≤–æ–π —Å–µ—Ä–≤–µ—Ä
   - –ü–æ–¥–ø–∏—Å–∫–∞ –¥–æ–ª–∂–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å—Å—è
   - –ü—Ä–æ–≤–µ—Ä—å –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏: <https://chatedem.com/admin>

---

## üîç –õ–æ–≥–∏ webhook

### –í Vercel

1. Vercel Dashboard ‚Üí **Deployments**
2. –í—ã–±–µ—Ä–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π
3. **Functions** ‚Üí `/api/yookassa/webhook`
4. –°–º–æ—Ç—Ä–∏ –ª–æ–≥–∏

### –í –∫–æ–¥–µ

Webhook –ª–æ–≥–∏—Ä—É–µ—Ç:

- –£—Å–ø–µ—à–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏
- –û—à–∏–±–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏
- –í—Å–µ —Å–æ–±—ã—Ç–∏—è YooKassa

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

1. **HTTPS –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω** ‚Äî YooKassa –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç webhook —Ç–æ–ª—å–∫–æ –Ω–∞ HTTPS
2. **URL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω** ‚Äî –ø—Ä–æ–≤–µ—Ä—å —á—Ç–æ <https://chatedem.com/api/yookassa/webhook> –æ—Ç–≤–µ—á–∞–µ—Ç
3. **Secret key** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)

---

## üéØ –ì–æ—Ç–æ–≤–æ

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ webhook:

- ‚úÖ –ü–ª–∞—Ç–µ–∂–∏ –±—É–¥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ü–æ–¥–ø–∏—Å–∫–∏ –±—É–¥—É—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—Ç Pro –¥–æ—Å—Ç—É–ø –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–ü—Ä–æ–≤–µ—Ä—å —Ä–∞–±–æ—Ç—É —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç–æ–≤—É—é –æ–ø–ª–∞—Ç—É!**
