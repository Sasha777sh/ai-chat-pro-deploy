# üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –£–ë–†–ê–¢–¨ –û–†–ö–ï–°–¢–†–ê–¢–û–† (–ù–ï –ë–´–õ –í –¢–ó)

## ‚úÖ –†–ï–®–ï–ù–ò–ï

**–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –ù–ï –±—ã–ª –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –¢–ó.**
**–í –¢–ó –±—ã–ª —Ç–æ–ª—å–∫–æ —Ä—É—á–Ω–æ–π –≤—ã–±–æ—Ä –≥–æ–ª–æ—Å–∞ —á–µ—Ä–µ–∑ `/chat/:voice_id`.**

**–î–µ–π—Å—Ç–≤–∏–µ:** –£–±—Ä–∞—Ç—å –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä, –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø—Ä–æ—Å—Ç–æ–π –ª–æ–≥–∏–∫–µ.

---

## üö® –ß–¢–û –ò–°–ü–†–ê–í–ò–¢–¨

### 1. –£–±—Ä–∞—Ç—å `autoSelectVoice` –∏–∑ `page.tsx`

**–ë—ã–ª–æ:**
```typescript
// src/app/page.tsx:153
autoSelectVoice: true, // –í–°–ï–ì–î–ê true!
```

**–°—Ç–∞–ª–æ:**
```typescript
// src/app/page.tsx:153
voiceId: voice, // –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≥–æ–ª–æ—Å
```

---

### 2. –£–±—Ä–∞—Ç—å –ª–æ–≥–∏–∫—É –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏–∑ API

**–ë—ã–ª–æ:**
```typescript
// src/app/api/chat/stream/route.ts:30-49
// EDEM ORCHESTRA: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –≥–æ–ª–æ—Å–∞, –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω
let voiceId: VoiceId = requestedVoiceId || 'live';

if (autoSelectVoice || !requestedVoiceId) {
  // ... –ª–æ–≥–∏–∫–∞ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞
  voiceId = orchestrateVoice(message, previousVoice);
}
```

**–°—Ç–∞–ª–æ:**
```typescript
// src/app/api/chat/stream/route.ts
let voiceId: VoiceId = requestedVoiceId || 'live';

if (!voiceId) {
  return new Response(
    JSON.stringify({ error: '–ì–æ–ª–æ—Å –Ω–µ –≤—ã–±—Ä–∞–Ω' }),
    { status: 400, headers: { 'Content-Type': 'application/json' } }
  );
}
```

---

### 3. –£–±—Ä–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å–µ—Å—Å–∏–∏ –ø–æ –≥–æ–ª–æ—Å—É (–æ–Ω–∞ –ª–æ–º–∞–µ—Ç —Å–º–µ–Ω—É –≥–æ–ª–æ—Å–∞)

**–ë—ã–ª–æ:**
```typescript
// src/app/api/chat/stream/route.ts:143
if (sessionRecord.voice_id !== voiceId) {
  return new Response(JSON.stringify({ error: '–°–µ—Å—Å–∏—è –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –¥—Ä—É–≥–æ–º—É –≥–æ–ª–æ—Å—É' }), ...);
}
```

**–°—Ç–∞–ª–æ:**
```typescript
// –£–±—Ä–∞—Ç—å —ç—Ç—É –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–ª–Ω–æ—Å—Ç—å—é
// –ò–ª–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å voice_id –≤ —Å–µ—Å—Å–∏–∏ –ø—Ä–∏ —Å–º–µ–Ω–µ –≥–æ–ª–æ—Å–∞
if (sessionRecord.voice_id !== voiceId) {
  await supabase
    .from('chat_sessions')
    .update({ voice_id: voiceId })
    .eq('id', sessionId);
}
```

---

### 4. –û–±–Ω–æ–≤–∏—Ç—å UI: –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Å–µ 5 –≥–æ–ª–æ—Å–æ–≤

**–ë—ã–ª–æ:**
```typescript
// src/components/ChatPanel.tsx:105
{VOICE_DEFINITIONS.slice(0, 3).map((voice) => ( // –¢–æ–ª—å–∫–æ 3 –≥–æ–ª–æ—Å–∞!
```

**–°—Ç–∞–ª–æ:**
```typescript
// –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Å–µ –≥–æ–ª–æ—Å–∞, –Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —Ç–∞—Ä–∏—Ñ—É
const allowedVoices = getAllowedVoices(subscriptionTier);
const availableVoices = VOICE_DEFINITIONS.filter(v => allowedVoices.includes(v.id));

{availableVoices.map((voice) => (
```

---

## üìã –ò–¢–û–ì–û–í–´–ô –ü–õ–ê–ù

1. ‚úÖ –£–±—Ä–∞—Ç—å `autoSelectVoice: true` ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `voiceId: voice`
2. ‚úÖ –£–±—Ä–∞—Ç—å –ª–æ–≥–∏–∫—É –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏–∑ API
3. ‚úÖ –£–±—Ä–∞—Ç—å/–∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å–µ—Å—Å–∏–∏ –ø–æ –≥–æ–ª–æ—Å—É
4. ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Å–µ 5 –≥–æ–ª–æ—Å–æ–≤ –≤ UI (—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —Ç–∞—Ä–∏—Ñ—É)
5. ‚úÖ –£–±—Ä–∞—Ç—å –∏–º–ø–æ—Ä—Ç `orchestrateVoice` (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

---

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –≥–æ–ª–æ—Å –≤—Ä—É—á–Ω—É—é ‚Üí –≥–æ–ª–æ—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –º–µ–∂–¥—É —Ä—É—á–Ω—ã–º –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—ã–±–æ—Ä–æ–º
- –ü—Ä–æ—Å—Ç–∞—è, –ø–æ–Ω—è—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∏—Å—Ö–æ–¥–Ω–æ–º—É –¢–ó

---

**–≠—Ç–æ –≤–µ—Ä–Ω—ë—Ç —Å–∏—Å—Ç–µ–º—É –∫ —Ä–∞–±–æ—á–µ–º—É MVP —Å–æ—Å—Ç–æ—è–Ω–∏—é, –∫–∞–∫ –±—ã–ª–æ –≤ –¢–ó.**

